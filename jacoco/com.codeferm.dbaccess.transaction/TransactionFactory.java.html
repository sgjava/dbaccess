<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TransactionFactory.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">DB Access</a> &gt; <a href="index.source.html" class="el_package">com.codeferm.dbaccess.transaction</a> &gt; <span class="el_source">TransactionFactory.java</span></div><h1>TransactionFactory.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) Steven P. Goldsmith. All rights reserved.
 *
 * Created by Steven P. Goldsmith on December 27, 2011
 * sgoldsmith@com.codeferm
 */
package com.codeferm.dbaccess.transaction;

import com.codeferm.dbaccess.DbAccessException;
import com.google.inject.AbstractModule;
import com.google.inject.Guice;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * Simple factory class that returns and Object with methods wrapped in a
 * transaction if the method is annotated with
 * {@link com.codeferm.dbaccess.transaction.Transaction}. The method interceptor
 * null {@link com.codeferm.dbaccess.transaction.AtomikosTransInterceptor},
 * {@link com.codeferm.dbaccess.transaction.QueryRunnerTransInterceptor} or
 * {@link com.codeferm.dbaccess.transaction.JdbcTransInterceptor} is binded with
 * Guice using {@link com.codeferm.dbaccess.transaction.AtomikosTransModule}.
 *
 * @see com.codeferm.dbaccess.transaction.Transaction
 * @see com.codeferm.dbaccess.transaction.AtomikosTransInterceptor
 * @see com.codeferm.dbaccess.transaction.AtomikosTransModule
 *
 * @author sgoldsmith
 * @version 1.0.0
 * @since 1.0.0
 */
public final class TransactionFactory {

    /**
     * Logger.
     */
    //CHECKSTYLE:OFF ConstantName - Logger is static final, not a constant
<span class="fc" id="L38">    private static final Logger log = LoggerFactory.getLogger(//NOPMD</span>
            TransactionFactory.class);
    //CHECKSTYLE:ON ConstantName

    /**
     * Suppress default constructor for non-instantiability.
     */
<span class="nc" id="L45">    private TransactionFactory() {</span>
<span class="nc" id="L46">        throw new AssertionError();</span>
    }

    /**
     * Create object of type T wrapped in transaction.
     *
     * @param &lt;T&gt; Return type.
     * @param clazz Type of object to create.
     * @param transModule Transaction module must extend AbstractModule.
     * @return Wrapped object.
     */
    public static &lt;T&gt; T createObject(final Class&lt;T&gt; clazz,
            final Class&lt;? extends AbstractModule&gt; transModule) {
<span class="pc bpc" id="L59" title="1 of 2 branches missed.">        if (log.isDebugEnabled()) {</span>
<span class="nc" id="L60">            log.debug(String.format(&quot;Creating transactional object for %s&quot;,</span>
                    clazz.getName()));
        }
<span class="fc" id="L63">        T object = null;</span>
        try {
<span class="fc" id="L65">            object = Guice.createInjector(transModule.newInstance()).</span>
                    getInstance(
                            clazz);
<span class="nc" id="L68">        } catch (InstantiationException e) {</span>
<span class="nc" id="L69">            throw new DbAccessException(e);</span>
<span class="nc" id="L70">        } catch (IllegalAccessException e) {</span>
<span class="nc" id="L71">            throw new DbAccessException(e);</span>
<span class="fc" id="L72">        }</span>
<span class="fc" id="L73">        return object;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>